<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>MQTT Web Control</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body>
  <h2>MQTT Web Client</h2>
  <button onclick="publishMessage()">送出控制訊息</button>
  <div id="status">尚未連線</div>

  <script>
    // 連接到 MQTT broker（需支援 WebSocket）
    const client = mqtt.connect('wss://broker.mqttgo.io:8084/mqtt');

    client.on('connect', () => {
      document.getElementById('status').innerText = '✅ 已連線到 MQTT Broker';

      // 訂閱主題
      client.subscribe('esp32/status', (err) => {
        if (!err) {
          console.log('已訂閱 esp32/status');
        }
      });
    });

    client.on('message', (topic, message) => {
      console.log(`收到訊息 [${topic}]: ${message.toString()}`);
      // 可依需求更新畫面
    });

    function publishMessage() {
      client.publish('esp32/control', 'toggle');
    }
  </script>
</body>
</html>
